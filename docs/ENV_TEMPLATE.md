# Environment Variables Reference

## Overview

All environment variables are automatically injected by the Manus platform. This document is for reference only - **you do not need to manually configure these variables**.

---

## System Environment Variables (Auto-Injected)

These variables are automatically provided by the Manus platform and should not be modified:

### Database
```bash
DATABASE_URL=mysql://user:password@host:port/database
# TiDB/MySQL connection string with SSL enabled
```

### Authentication (OAuth)
```bash
JWT_SECRET=<auto-generated-secret>
# Session cookie signing secret

VITE_APP_ID=<your-app-id>
# Manus OAuth application ID

OAUTH_SERVER_URL=https://api.manus.im
# OAuth backend base URL

VITE_OAUTH_PORTAL_URL=https://portal.manus.im
# OAuth login portal URL (frontend)

OWNER_OPEN_ID=<owner-openid>
# Owner's OAuth identifier

OWNER_NAME=<owner-name>
# Owner's display name
```

### Application Settings
```bash
VITE_APP_TITLE="Precision Radiation Oncology Solutions"
# Application title shown in UI

VITE_APP_LOGO=<logo-url>
# Logo image URL
```

### Manus Built-in APIs
```bash
BUILT_IN_FORGE_API_URL=https://forge-api.manus.im
# Manus built-in APIs (LLM, storage, notifications)

BUILT_IN_FORGE_API_KEY=<server-api-key>
# Bearer token for server-side API calls

VITE_FRONTEND_FORGE_API_KEY=<frontend-api-key>
# Bearer token for frontend API calls

VITE_FRONTEND_FORGE_API_URL=https://forge-api.manus.im
# Manus built-in APIs URL for frontend
```

### AI Integration
```bash
AIMLAPI_KEY=<aimlapi-key>
# API key for aimlapi.com (content generation, resume analysis)
```

### Analytics
```bash
VITE_ANALYTICS_ENDPOINT=<analytics-endpoint>
# Analytics tracking endpoint

VITE_ANALYTICS_WEBSITE_ID=<website-id>
# Website identifier for analytics
```

---

## User-Configurable Variables (Add via Management UI)

These variables need to be added by you through the Management UI → Settings → Secrets:

### Email Notifications (Mailgun)
```bash
MAILGUN_API_KEY=<your-mailgun-api-key>
# Get from: https://app.mailgun.com/app/account/security/api_keys

MAILGUN_DOMAIN=<your-mailgun-domain>
# Your verified domain (e.g., mg.prosradiationoncology.com)

MAILGUN_FROM_EMAIL=<sender-email>
# Sender email address (e.g., noreply@prosradiationoncology.com)
```

**How to get Mailgun credentials:**
1. Sign up at [mailgun.com](https://www.mailgun.com) (free tier: 5,000 emails/month)
2. Verify your domain by adding DNS records
3. Get API key from Account → Settings → API Keys
4. Use your verified domain as `MAILGUN_DOMAIN`
5. Choose a sender email (must be from your verified domain)

### Google Analytics (Optional)
```bash
VITE_GA_TRACKING_ID=<ga-tracking-id>
# Google Analytics tracking ID (e.g., G-XXXXXXXXXX)
```

**How to get Google Analytics ID:**
1. Sign up at [analytics.google.com](https://analytics.google.com)
2. Create a new property for your website
3. Get the Measurement ID (starts with G-)
4. Add to environment variables
5. Update `client/index.html` to include GA script

---

## Adding Environment Variables

### Via Management UI (Recommended)

1. Open Management UI (right panel)
2. Go to **Settings → Secrets**
3. Click **"Add Secret"**
4. Enter key name (e.g., `MAILGUN_API_KEY`)
5. Enter value
6. Click **"Save"**
7. Restart dev server or redeploy

### Via Vercel Dashboard (For Production)

1. Go to Vercel dashboard
2. Select your project
3. Go to **Settings → Environment Variables**
4. Add variables for Production, Preview, and Development
5. Redeploy to apply changes

**Note:** System variables (DATABASE_URL, JWT_SECRET, etc.) are automatically synced by Manus platform. Only add user-configurable variables manually.

---

## Environment Variable Validation

The application validates required environment variables on startup. Check `server/_core/env.ts` for the complete validation logic.

### Required Variables (Auto-Injected)
- `DATABASE_URL`
- `JWT_SECRET`
- `VITE_APP_ID`
- `OAUTH_SERVER_URL`
- `VITE_OAUTH_PORTAL_URL`
- `BUILT_IN_FORGE_API_URL`
- `BUILT_IN_FORGE_API_KEY`

### Optional Variables (User-Configured)
- `MAILGUN_API_KEY` - Email notifications won't work without this
- `MAILGUN_DOMAIN` - Required if MAILGUN_API_KEY is set
- `MAILGUN_FROM_EMAIL` - Required if MAILGUN_API_KEY is set
- `VITE_GA_TRACKING_ID` - Analytics won't track without this

---

## Security Best Practices

### DO ✅
- Use Management UI → Settings → Secrets for sensitive values
- Rotate API keys periodically (every 90 days)
- Use different keys for development and production
- Keep `.env` files in `.gitignore` (already configured)
- Use environment-specific values (dev vs prod)

### DON'T ❌
- Commit `.env` files to Git
- Share API keys in chat or email
- Use production keys in development
- Hard-code secrets in source code
- Expose API keys in frontend code (use VITE_ prefix only for non-sensitive values)

---

## Troubleshooting

### Issue: "Missing required environment variable"
**Solution:** Check that all required variables are set in Management UI → Settings → Secrets

### Issue: Email notifications not working
**Solution:** Verify Mailgun credentials:
```bash
# Test Mailgun API key
curl -s --user 'api:YOUR_API_KEY' \
  https://api.mailgun.net/v3/YOUR_DOMAIN/messages \
  -F from='noreply@YOUR_DOMAIN' \
  -F to='test@example.com' \
  -F subject='Test' \
  -F text='Test message'
```

### Issue: OAuth login fails
**Solution:** Verify OAuth variables are set correctly:
- `VITE_APP_ID` should match your Manus application ID
- `OAUTH_SERVER_URL` should be `https://api.manus.im`
- `VITE_OAUTH_PORTAL_URL` should be `https://portal.manus.im`

### Issue: Database connection fails
**Solution:** Check `DATABASE_URL` format:
```
mysql://username:password@host:port/database?ssl={"rejectUnauthorized":true}
```

---

## Reference: Variable Naming Conventions

### Prefix Meanings
- `VITE_` - Exposed to frontend (bundled in client code)
- No prefix - Server-side only (not exposed to frontend)

### Examples
```bash
# Frontend-accessible (use for non-sensitive config)
VITE_APP_TITLE="My App"
VITE_GA_TRACKING_ID="G-XXXXXXXXXX"

# Server-side only (use for sensitive data)
DATABASE_URL="mysql://..."
JWT_SECRET="secret-key"
MAILGUN_API_KEY="key-xxxxx"
```

**Important:** Never use `VITE_` prefix for sensitive values (API keys, secrets) as they will be exposed in the frontend bundle!

---

## Need Help?

- **Manus Platform:** [https://help.manus.im](https://help.manus.im)
- **Mailgun Support:** [https://help.mailgun.com](https://help.mailgun.com)
- **Vercel Support:** [https://vercel.com/support](https://vercel.com/support)
